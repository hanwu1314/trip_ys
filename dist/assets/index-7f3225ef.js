import{c as j,n as F,m as X,L as J,t as K,Q as O,d as W,q as Z,b as p,aP as $,s as ee,a as f,I as x,_ as G,p as te,f as ae,w as oe}from"./index-6b5df6f3.js";import{u as le,b as se}from"./index-d805b1e0.js";const[ne,h]=j("rate");function ie(t,n,s,r){return t>=n?{status:"full",value:1}:t+.5>=n&&s&&!r?{status:"half",value:.5}:t+1>=n&&s&&r?{status:"half",value:Math.round((t-n+1)*1e10)/1e10}:{status:"void",value:0}}const re={size:F,icon:X("star"),color:String,count:J(5),gutter:F,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:X("star-o"),allowHalf:Boolean,voidColor:String,touchable:K,iconPrefix:String,modelValue:O(0),disabledColor:String};var ue=W({name:ne,props:re,emits:["change","update:modelValue"],setup(t,{emit:n}){const s=le(),[r,S]=se(),m=Z(),T=p(()=>t.readonly||t.disabled),I=p(()=>T.value||!t.touchable),L=p(()=>Array(+t.count).fill("").map((a,e)=>ie(t.modelValue,e+1,t.allowHalf,t.readonly)));let l,u,g=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER;const V=()=>{u=G(m);const a=r.value.map(G);l=[],a.forEach((e,o)=>{g=Math.min(e.top,g),b=Math.max(e.top,b),t.allowHalf?l.push({score:o+.5,left:e.left,top:e.top,height:e.height},{score:o+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:o+1,left:e.left,top:e.top,height:e.height})})},N=(a,e)=>{for(let o=l.length-1;o>0;o--)if(e>=u.top&&e<=u.bottom){if(a>l[o].left&&e>=l[o].top&&e<=l[o].top+l[o].height)return l[o].score}else{const c=e<u.top?g:b;if(a>l[o].left&&l[o].top===c)return l[o].score}return t.allowHalf?.5:1},w=a=>{T.value||a===t.modelValue||(n("update:modelValue",a),n("change",a))},Y=a=>{I.value||(s.start(a),V())},q=a=>{if(!I.value&&(s.move(a),s.isHorizontal()&&!s.isTap.value)){const{clientX:e,clientY:o}=a.touches[0];te(a),w(N(e,o))}},D=(a,e)=>{const{icon:o,size:c,color:y,count:C,gutter:E,voidIcon:k,disabled:i,voidColor:_,allowHalf:z,iconPrefix:H,disabledColor:M}=t,v=e+1,R=a.status==="full",d=a.status==="void",Q=z&&a.value>0&&a.value<1;let B;E&&v!==+C&&(B={paddingRight:ae(E)});const U=A=>{V();let P=z?N(A.clientX,A.clientY):v;t.clearable&&s.isTap.value&&P===t.modelValue&&(P=0),w(P)};return f("div",{key:e,ref:S(e),role:"radio",style:B,class:h("item"),tabindex:i?void 0:0,"aria-setsize":C,"aria-posinset":v,"aria-checked":!d,onClick:U},[f(x,{size:c,name:R?o:k,class:h("icon",{disabled:i,full:R}),color:i?M:R?y:_,classPrefix:H},null),Q&&f(x,{size:c,style:{width:a.value+"em"},name:d?k:o,class:h("icon",["half",{disabled:i,full:!d}]),color:i?M:d?_:y,classPrefix:H},null)])};return $(()=>t.modelValue),ee("touchmove",q,{target:m}),()=>f("div",{ref:m,role:"radiogroup",class:h({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstartPassive:Y},[L.value.map(D)])}});const fe=oe(ue);export{fe as R};
